<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>Simplify Azure Management Group Setup Using Bicep Vending - DevJev.nl | Azure, Cloud Security &amp; DevOps Insights for IT Professionals</title><meta name="author" content="Jev">
<meta name="description" content="Streamline your Azure environment with a reusable Bicep solution that deploys hierarchical management groups based on the Cloud Adoption Framework (CAF). Includes step-by-step guidance and code examples."><meta name="keywords" content='Azure, Bicep, Cloud Adoption Framework, Management Groups'>
  <meta itemprop="name" content="Simplify Azure Management Group Setup using Bicep Vending">
  <meta itemprop="description" content="Streamline your Azure environment with a reusable Bicep solution that deploys hierarchical management groups based on the Cloud Adoption Framework (CAF). Includes step-by-step guidance and code examples.">
  <meta itemprop="datePublished" content="2025-01-07T02:00:00+02:00">
  <meta itemprop="dateModified" content="2025-01-07T02:00:00+02:00">
  <meta itemprop="wordCount" content="956">
  <meta itemprop="image" content="https://www.devjev.nl/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/featured-image.png">
  <meta itemprop="keywords" content="Azure,Bicep,Cloud Adoption Framework,Management Groups"><meta property="og:url" content="https://www.devjev.nl/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/">
  <meta property="og:site_name" content="DevJev.nl | Azure, Cloud Security & DevOps Insights for IT Professionals">
  <meta property="og:title" content="Simplify Azure Management Group Setup using Bicep Vending">
  <meta property="og:description" content="Streamline your Azure environment with a reusable Bicep solution that deploys hierarchical management groups based on the Cloud Adoption Framework (CAF). Includes step-by-step guidance and code examples.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-01-07T02:00:00+02:00">
    <meta property="article:modified_time" content="2025-01-07T02:00:00+02:00">
    <meta property="article:tag" content="Azure">
    <meta property="article:tag" content="Bicep">
    <meta property="article:tag" content="Cloud Adoption Framework">
    <meta property="article:tag" content="Management Groups">
    <meta property="og:image" content="https://www.devjev.nl/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/featured-image.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://www.devjev.nl/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/featured-image.png">
  <meta name="twitter:title" content="Simplify Azure Management Group Setup using Bicep Vending">
  <meta name="twitter:description" content="Streamline your Azure environment with a reusable Bicep solution that deploys hierarchical management groups based on the Cloud Adoption Framework (CAF). Includes step-by-step guidance and code examples.">
      <meta name="twitter:site" content="@DevJevNL">
<meta name="twitter:creator" content="@DevJevNL" /><meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="https://www.devjev.nl/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/" title="Simplify Azure Management Group Setup using Bicep Vending - DevJev.nl | Azure, Cloud Security &amp; DevOps Insights for IT Professionals" /><link rel="prev" type="text/html" href="https://www.devjev.nl/posts/2024/decoding-microsoft-azure-landing-zones-explained/" title=" üîç Decoding Microsoft Azure: Landing Zones Explained üõ¨" /><link rel="next" type="text/html" href="https://www.devjev.nl/posts/2025/automating-azure-devops-auditing-configure-streams-with-powershell/" title="üìä Automating Azure DevOps Auditing: Configure Streams with PowerShell" /><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Simplify Azure Management Group Setup using Bicep Vending",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/www.devjev.nl\/posts\/2025\/simplify-azure-management-group-setup-using-bicep-vending\/"
    },"image": [{
              "@type": "ImageObject",
              "url": "https:\/\/www.devjev.nl\/posts\/2025\/simplify-azure-management-group-setup-using-bicep-vending\/featured-image.png",
              "width":  1024 ,
              "height":  669 
            }],"genre": "posts","keywords": "Azure, Bicep, Cloud Adoption Framework, Management Groups","wordcount":  956 ,
    "url": "https:\/\/www.devjev.nl\/posts\/2025\/simplify-azure-management-group-setup-using-bicep-vending\/","datePublished": "2025-01-07T02:00:00+02:00","dateModified": "2025-01-07T02:00:00+02:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "Jev"
      },"description": "Streamline your Azure environment with a reusable Bicep solution that deploys hierarchical management groups based on the Cloud Adoption Framework (CAF). Includes step-by-step guidance and code examples."
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="fixed" data-header-mobile="auto"><div class="wrapper" data-page-style="custom"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="DevJev.nl | Azure, Cloud Security &amp; DevOps Insights for IT Professionals"><span class="header-title-text">DevJev.nl</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/posts/" title="Blog posts">Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/" title="Post categories">Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/" title="Tags used in posts">Tags</a></li><li class="menu-item">
              <a class="menu-link" href="/about/" title="About Me">About</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Search titles or contents ..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="DevJev.nl | Azure, Cloud Security &amp; DevOps Insights for IT Professionals"><span class="header-title-text">DevJev.nl</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Search titles or contents ..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Cancel
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/posts/" title="Blog posts">Posts</a></li><li class="menu-item"><a class="menu-link" href="/categories/" title="Post categories">Categories</a></li><li class="menu-item"><a class="menu-link" href="/tags/" title="Tags used in posts">Tags</a></li><li class="menu-item"><a class="menu-link" href="/about/" title="About Me">About</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>Simplify Azure Management Group Setup Using Bicep Vending</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      Jev</span></span><span class="post-included-in">&nbsp;included in <a href="/categories/azure-governance/" class="post-category" title="Category - Azure Governance"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Azure Governance</a>&ensp;<a href="/categories/azure-bicep/" class="post-category" title="Category - Azure Bicep"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Azure Bicep</a>&ensp;<a href="/categories/how-to/" class="post-category" title="Category - How To"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> How To</a>&ensp;<a href="/categories/tenant-landing-zone/" class="post-category" title="Category - Tenant Landing Zone"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Tenant Landing Zone</a></span></div><div class="post-meta-line"><span title="published on 2025-01-07 02:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-01-07">2025-01-07</time></span>&nbsp;<span title="956 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 1000 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>5 minutes</span>&nbsp;</div>
    </div><div class="featured-image"><img src='/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/featured-image.png' alt="/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/featured-image.png"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#understanding-the-need-for-management-group-automation">Understanding the Need for Management Group Automation</a></li>
    <li><a href="#design-for-vending">Design for Vending</a></li>
    <li><a href="#build-the-management-group-vending-bicep-solution">Build the Management Group Vending Bicep Solution</a>
      <ul>
        <li><a href="#resource-module">Resource Module</a></li>
        <li><a href="#solution-bicep-file">Solution Bicep File</a></li>
        <li><a href="#parameters-file">Parameters File</a>
          <ul>
            <li><a href="#management-group-naming-convention">Management group naming convention</a></li>
          </ul>
        </li>
        <li><a href="#deploy-your-management-group-structure">Deploy Your Management Group Structure</a>
          <ul>
            <li><a href="#deployment-steps">Deployment Steps</a></li>
          </ul>
        </li>
        <li><a href="#key-considerations">Key Considerations</a></li>
      </ul>
    </li>
    <li><a href="#wrapping-up">Wrapping up</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="understanding-the-need-for-management-group-automation"><span>Understanding the Need for Management Group Automation</span>
  <a href="#understanding-the-need-for-management-group-automation" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Managing Azure subscriptions at scale can become challenging. Management groups provide a powerful way to organize and govern resources, but manually configuring them introduces inefficiencies and risks. A common pitfall is hardcoding management group structures into deployment code, which reduces flexibility and can compromise governance.
This post introduces Management Group Vending, a reusable Bicep solution inspired by Microsoft&rsquo;s <a href="https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">Subscription Vending</a>. This solution enables you to deploy any management group hierarchy, considering Azure&rsquo;s limitations while adhering to Cloud Adoption Framework (CAF) principles.</p>
<h2 class="heading-element" id="design-for-vending"><span>Design for Vending</span>
  <a href="#design-for-vending" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>As of writing this post the maximum depth limit for management groups is 6 levels. This limitation is very helpful it means that out scope is limited to 6 levels.
So we can slice any kind of Management Group structure into a maximum of 6 levels or as I like to call them tiers. As an practice example lets use this approach on the management group
structure as show in the <a href="https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/enterprise-scale/media/azure-landing-zone-architecture-diagram-hub-spoke.svg?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">Azure landing zone conceptual architecture</a> part of the <a href="https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">Cloud Adoption Framework (CAF)</a>.
The CAF conceptual architecture serves as a solid foundation for designing management group hierarchies, as it reflects industry best practices for organizing Azure resources.</p>
<p>Slicing this management groups structure into tiers would have the following structure:</p>
<ul>
<li><strong>Tier 0:</strong> <code>Contoso</code> <em>(Corporate Root)</em></li>
<li><strong>Tier 1:</strong> <code>Platform</code>, <code>Landing Zones</code>, <code>Decommissioned</code>, <code>Sandbox</code></li>
<li><strong>Tier 2:</strong> <code>Management</code>, <code>Identity</code>, <code>Connectivity</code>, <code>Corp</code>, <code>Online</code></li>
<li><strong>Tier 3:</strong> <em>Unused</em></li>
<li><strong>Tier 4:</strong> <em>Unused</em></li>
<li><strong>Tier 5:</strong> <em>Unused</em></li>
</ul>
<p>And visualized as follows:</p>
<figure><a class="lightgallery" href="/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/caf-management-groups.png" title="/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/caf-management-groups.png" data-thumbnail="/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/caf-management-groups.png" data-sub-html="<h2>Management Group Vending applied to Microsoft Enterprise Landing Zone</h2>"><img loading="lazy" src='/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/caf-management-groups.png' alt="/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/caf-management-groups.png" height="632" width="1591"></a><figcaption class="image-caption">Management Group Vending applied to Microsoft Enterprise Landing Zone</figcaption>
  </figure>
<div class="details admonition info open">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-circle-info" aria-hidden="true"></i>Why start at zero?<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
  <div class="details-content">
    <div class="admonition-content">The first tier represents the corporate root management group, which is a single entity. Starting at zero emphasizes its uniqueness compared to subsequent tiers, which are collections. This approach improves both readability and maintainability.</div>
  </div>
</div>
<p>Now that the tier model is clear lets compose the solution which implements this model.
First we have to have a solution bicep file. This is the main execution file which will be executed to deploy the vending solution. This file will contain the logic to deploy the management groups in the correct order and depth.
Next we need a bicep resource module. This module will contain the logic to deploy a single management group, hence the resource module. This module is called by the solution bicep file for each management group in a tier. Finally
we need a parameter file which provides the collections of management groups to be deployed. On the back of an envelope design would looks something like this:</p>
<figure><a class="lightgallery" href="/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/management-group-vending-structure.png" title="/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/management-group-vending-structure.png" data-thumbnail="/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/management-group-vending-structure.png" data-sub-html="<h2>Management Group Vending Structure</h2>"><img loading="lazy" src='/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/management-group-vending-structure.png' alt="/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/management-group-vending-structure.png" height="982" width="1115"></a><figcaption class="image-caption">Management Group Vending Structure</figcaption>
  </figure>
<h2 class="heading-element" id="build-the-management-group-vending-bicep-solution"><span>Build the Management Group Vending Bicep Solution</span>
  <a href="#build-the-management-group-vending-bicep-solution" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>The solution is composed of three main components:</p>
<h3 class="heading-element" id="resource-module"><span>Resource Module</span>
  <a href="#resource-module" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>The resource module is the core building block of the solution. It leverages the <code>Microsoft.Management/managementGroups@2021-04-01</code> namespace to create individual management groups. The key aspect here is the <code>targetScope = 'managementGroup'</code> property, which allows the deployment of management groups within the correct scope.</p>
<p>This module handles the creation of a single management group, including setting its ID, display name, and parent ID. This modular design ensures reusability and keeps the logic for creating management groups isolated.</p>
<p>Below is an example of a simple resource module:</p>
<script src="https://gist.github.com/devjevnl/e105714f7e921eac62296a80256fdac8.js?file=resourceModule.bicep"></script>
<h3 class="heading-element" id="solution-bicep-file"><span>Solution Bicep File</span>
  <a href="#solution-bicep-file" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>The solution Bicep file acts as the orchestrator. It consumes the resource module to deploy the management group hierarchy tier by tier. Each tier is represented as a collection of management groups, except for Tier 0, which is the single <code>corporate root management group</code>.</p>
<p>Key highlights of the solution file include:</p>
<ul>
<li><strong>Tier Dependencies</strong>: Each tier depends on the successful creation of its parent tier. This ensures management groups are deployed in the correct order and hierarchy.</li>
<li><strong>Default Management Group</strong>: Optionally, you can set a default management group for new subscriptions using the <code>IdOfDefaultManagementGroupForNewSubscriptions</code> parameter.</li>
<li><strong>Permission Settings</strong>: The solution allows you to configure whether permissions are required for creating new management groups via the <code>RequireWritePermissionsForNewManagementGroupCreation</code> parameter.</li>
</ul>
<p>Here is an example of a solution Bicep file:</p>
<script src="https://gist.github.com/devjevnl/e105714f7e921eac62296a80256fdac8.js?file=solutionModule.bicep"></script>
<h3 class="heading-element" id="parameters-file"><span>Parameters File</span>
  <a href="#parameters-file" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>The parameter file defines the hierarchy of management groups in a JSON format. Each tier is represented as an object containing the management groups within that tier, along with their IDs, display names, and parent IDs.</p>
<p>For example, here is an <a href="https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/enterprise-scale/media/azure-landing-zone-architecture-diagram-hub-spoke.svg?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">Azure landing zone conceptual architecture</a> populated parameter file:</p>
<script src="https://gist.github.com/devjevnl/e105714f7e921eac62296a80256fdac8.js?file=managementGroupParameter.json"></script>
<h4 class="heading-element" id="management-group-naming-convention"><span>Management group naming convention</span>
  <a href="#management-group-naming-convention" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>For anything Infrastructure as Code related a strong naming convention is a crucial cornerstone. Luckily I already have a strong naming convention for management groups, which I have written about in a previous post <a href="https://www.devjev.nl/posts/2022/the-ideal-management-group-naming-convention/"target="_blank" rel="external nofollow noopener noreferrer">The ideal Management group naming convention</a>.</p>
<h3 class="heading-element" id="deploy-your-management-group-structure"><span>Deploy Your Management Group Structure</span>
  <a href="#deploy-your-management-group-structure" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>To deploy the management group structure, you need to perform a tenant-level deployment. This is required because management groups are tenant-level resources. The solution&rsquo;s Bicep file specifies <code>targetScope = 'tenant'</code> to accommodate this.</p>
<h4 class="heading-element" id="deployment-steps"><span>Deployment Steps</span>
  <a href="#deployment-steps" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><ol>
<li>
<p>Ensure Permissions: Tenant-level deployments require elevated access. Even the <code>Global Administrator</code> role does not have these permissions by default. You can grant the necessary permissions by following these guides:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/templates/deploy-to-tenant?tabs=azure-cli#required-access?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">Required Access</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin?WT.mc_id=DT-MVP-5004039&amp;tabs=azure-portal?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">Elevate Access for Global Admins</a></li>
</ul>
</li>
<li>
<p>Run the Deployment: Use the following PowerShell snippet to initiate the deployment:</p>
</li>
</ol>
<script src="https://gist.github.com/devjevnl/e105714f7e921eac62296a80256fdac8.js?file=tenantLevelDeployment.ps1"></script>
<h3 class="heading-element" id="key-considerations"><span>Key Considerations</span>
  <a href="#key-considerations" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><strong>Deployment Order</strong>: Ensure the parameter file is correctly structured to reflect the hierarchy and tier dependencies.</li>
<li><strong>Validation</strong>: Always test the deployment in a canary/sandbox environment before applying it to your production tenant.</li>
</ul>
<h2 class="heading-element" id="wrapping-up"><span>Wrapping up</span>
  <a href="#wrapping-up" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>And that&rsquo;s a wrap, if you found this post useful, be sure to explore the reference materials that inspired this solution:</p>
<ul>
<li><a href="https://teamtopologies.com/key-concepts"target="_blank" rel="external nofollow noopener noreferrer">Key Concepts - Team Topologies</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">Subscription Vending</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/enterprise-scale/media/azure-landing-zone-architecture-diagram-hub-spoke.svg?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">Azure landing zone conceptual architecture</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">Cloud Adoption Framework (CAF)</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/templates/deploy-to-tenant?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">Tenant deployments with ARM templates</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin?WT.mc_id=DT-MVP-5004039&amp;tabs=azure-portal?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">Elevate access to manage all Azure subscriptions and management groups</a></li>
<li><a href="https://blog.tyang.org/2022/02/27/management-group-bicep-module"target="_blank" rel="external nofollow noopener noreferrer">Azure Bicep Module for Management Group Hierarchy</a></li>
<li><a href="https://www.devjev.nl/posts/2022/the-ideal-management-group-naming-convention/"target="_blank" rel="external nofollow noopener noreferrer">The ideal Management group naming convention</a></li>
</ul>
<p><strong>Thank you</strong> so much for taking the time to read this post. If you enjoyed it or learned something new, don‚Äôt hesitate to check out my other <a href="/posts">posts</a>.</p>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Updated on 2025-01-07 02:00:00">Updated on 2025-01-07&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/azure/" class="post-tag" title="Tags - Azure">Azure</a><a href="/tags/bicep/" class="post-tag" title="Tags - Bicep">Bicep</a><a href="/tags/cloud-adoption-framework/" class="post-tag" title="Tags - Cloud Adoption Framework">Cloud Adoption Framework</a><a href="/tags/management-groups/" class="post-tag" title="Tags - Management Groups">Management Groups</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/2024/decoding-microsoft-azure-landing-zones-explained/" class="post-nav-item" rel="prev" title=" üîç Decoding Microsoft Azure: Landing Zones Explained üõ¨"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i> üîç Decoding Microsoft Azure: Landing Zones Explained üõ¨</a><a href="/posts/2025/automating-azure-devops-auditing-configure-streams-with-powershell/" class="post-nav-item" rel="next" title="üìä Automating Azure DevOps Auditing: Configure Streams With PowerShell">üìä Automating Azure DevOps Auditing: Configure Streams With PowerShell<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="custom-footer-text">
  <p>¬© 2025 Jev Suchoi - Let's automate the boring! </p>
</div>
<div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><span class="author" itemprop="copyrightHolder">
              <a href="/"></a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="/posts/2025/simplify-azure-management-group-setup-using-bicep-vending/config.js" defer></script><script src="/js/theme.min.js" defer></script><script>
      window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
      gtag('config', 'G-J3E897NYLC');
    </script><script src="https://www.googletagmanager.com/gtag/js?id=G-J3E897NYLC" async></script></body>
</html>
