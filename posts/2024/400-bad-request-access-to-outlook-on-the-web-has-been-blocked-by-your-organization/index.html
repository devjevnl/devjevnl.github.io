<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>üö´ 400 Bad Request. Access to Outlook on the Web Has Been Blocked by Your Organization üõë‚úâÔ∏èüîí - DevJev.nl | Azure, Cloud Security &amp; DevOps Insights for IT Professionals</title><meta name="author" content="Jev">
<meta name="description" content="LOL"><meta name="keywords" content='Exchange Online, Outlook, Microsoft 365, Troubleshooting'>
  <meta itemprop="name" content="üö´ 400 Bad Request. Access to Outlook on the web has been blocked by your organization üõë‚úâÔ∏èüîí">
  <meta itemprop="description" content="LOL">
  <meta itemprop="datePublished" content="2024-04-29T02:00:00+02:00">
  <meta itemprop="dateModified" content="2024-04-29T02:00:00+02:00">
  <meta itemprop="wordCount" content="873">
  <meta itemprop="image" content="https://www.devjev.nl/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/featured-image.png">
  <meta itemprop="keywords" content="Exchange Online,Outlook,Microsoft 365,Troubleshooting"><meta property="og:url" content="https://www.devjev.nl/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/">
  <meta property="og:site_name" content="DevJev.nl | Azure, Cloud Security & DevOps Insights for IT Professionals">
  <meta property="og:title" content="üö´ 400 Bad Request. Access to Outlook on the web has been blocked by your organization üõë‚úâÔ∏èüîí">
  <meta property="og:description" content="LOL">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-29T02:00:00+02:00">
    <meta property="article:modified_time" content="2024-04-29T02:00:00+02:00">
    <meta property="article:tag" content="Exchange Online">
    <meta property="article:tag" content="Outlook">
    <meta property="article:tag" content="Microsoft 365">
    <meta property="article:tag" content="Troubleshooting">
    <meta property="og:image" content="https://www.devjev.nl/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/featured-image.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://www.devjev.nl/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/featured-image.png">
  <meta name="twitter:title" content="üö´ 400 Bad Request. Access to Outlook on the web has been blocked by your organization üõë‚úâÔ∏èüîí">
  <meta name="twitter:description" content="LOL">
      <meta name="twitter:site" content="@DevJevNL">
<meta name="twitter:creator" content="@DevJevNL" /><meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="https://www.devjev.nl/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/" title="üö´ 400 Bad Request. Access to Outlook on the web has been blocked by your organization üõë‚úâÔ∏èüîí - DevJev.nl | Azure, Cloud Security &amp; DevOps Insights for IT Professionals" /><link rel="prev" type="text/html" href="https://www.devjev.nl/posts/2024/how-to-build-and-use-your-own-container-with-azure-devops-container-jobs/" title="üõ†Ô∏è How to Build and Use Your Own Container with Azure DevOps Container Jobs üöÄüì¶" /><link rel="next" type="text/html" href="https://www.devjev.nl/posts/2024/i-am-in-your-pipeline-decorating-it-with-compliance/" title="üöÄ‚ú® I am in your pipeline, decorating it with compliance üõ†Ô∏èüîí" /><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "üö´ 400 Bad Request. Access to Outlook on the web has been blocked by your organization üõë‚úâÔ∏èüîí",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/www.devjev.nl\/posts\/2024\/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization\/"
    },"image": [{
              "@type": "ImageObject",
              "url": "https:\/\/www.devjev.nl\/posts\/2024\/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization\/featured-image.png",
              "width":  800 ,
              "height":  552 
            }],"genre": "posts","keywords": "Exchange Online, Outlook, Microsoft 365, Troubleshooting","wordcount":  873 ,
    "url": "https:\/\/www.devjev.nl\/posts\/2024\/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization\/","datePublished": "2024-04-29T02:00:00+02:00","dateModified": "2024-04-29T02:00:00+02:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "Jev"
      },"description": "LOL"
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="fixed" data-header-mobile="auto"><div class="wrapper" data-page-style="custom"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="DevJev.nl | Azure, Cloud Security &amp; DevOps Insights for IT Professionals"><span class="header-title-text">DevJev.nl</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/posts/" title="Blog posts">Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/" title="Post categories">Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/" title="Tags used in posts">Tags</a></li><li class="menu-item">
              <a class="menu-link" href="/about/" title="About Me">About</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Search titles or contents ..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="DevJev.nl | Azure, Cloud Security &amp; DevOps Insights for IT Professionals"><span class="header-title-text">DevJev.nl</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Search titles or contents ..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Cancel
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/posts/" title="Blog posts">Posts</a></li><li class="menu-item"><a class="menu-link" href="/categories/" title="Post categories">Categories</a></li><li class="menu-item"><a class="menu-link" href="/tags/" title="Tags used in posts">Tags</a></li><li class="menu-item"><a class="menu-link" href="/about/" title="About Me">About</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>üö´ 400 Bad Request. Access to Outlook on the Web Has Been Blocked by Your Organization üõë‚úâÔ∏èüîí</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      Jev</span></span><span class="post-included-in">&nbsp;included in <a href="/categories/exchange-online/" class="post-category" title="Category - Exchange Online"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Exchange Online</a>&ensp;<a href="/categories/outlook/" class="post-category" title="Category - Outlook"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Outlook</a>&ensp;<a href="/categories/microsoft-365/" class="post-category" title="Category - Microsoft 365"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Microsoft 365</a>&ensp;<a href="/categories/troubleshooting/" class="post-category" title="Category - Troubleshooting"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Troubleshooting</a></span></div><div class="post-meta-line"><span title="published on 2024-04-29 02:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2024-04-29">2024-04-29</time></span>&nbsp;<span title="873 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 900 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>5 minutes</span>&nbsp;</div>
    </div><div class="featured-image"><img src='/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/featured-image.png' alt="/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/featured-image.png"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#the-issue">The Issue</a></li>
    <li><a href="#the-root-cause">The Root Cause</a></li>
    <li><a href="#the-solution">The Solution</a></li>
    <li><a href="#wrapping-up">Wrapping up</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><p>While this post is outside of my usual topics, I would like to share a solution for an error message which returns just a single search result on Google. I want to share it because it took me some time to figure out what was going on. So in case someone else runs into this issue this post might be helpful.</p>
<h2 class="heading-element" id="the-issue"><span>The Issue</span>
  <a href="#the-issue" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>It all started after the network team updated the network to a new public IP. Right after this change all users started to get the error message <code>400 Bad Request. QWNjZXNzIHRvIE91dGxvb2sgb24gdGhlIHdlYiBoYXMgYmVlbiBibG9ja2VkIGJ5 IHlvdXIgb3JnYW5pemF0aW9uLiA8QlI+PEJSPkNsaWNrIDxhIGhyZWY9Ii9vd2Ev bG9nb2ZmLm93YSI+aGVyZTwvYT4gdG8gc2lnbiBvdXQu (Base64)</code> when trying to access Outlook on the web (OWA) in Microsoft 365.</p>
<figure><a class="lightgallery" href="/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/badRequest.png" title="/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/badRequest.png" data-thumbnail="/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/badRequest.png" data-sub-html="<h2>Outlook Web App - 400 Bad Request</h2>"><img loading="lazy" src='/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/badRequest.png' alt="/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/badRequest.png" height="648" width="1714"></a><figcaption class="image-caption">Outlook Web App - 400 Bad Request</figcaption>
  </figure>
<p>And in case you are wondering, the decoded the Base64 string of the error message reads: <code>Access to Outlook on the web has been blocked by your organization. &lt;BR&gt;&lt;BR&gt;Click &lt;a href=&quot;/owa/logoff.owa&quot;&gt;here&lt;/a&gt; to sign out.</code></p>
<p>What made this a bit more peculiar is that this error was shown <strong>only</strong> when accessing <a href="https://outlook.office.com/"target="_blank" rel="external nofollow noopener noreferrer">https://outlook.office.com/</a> (Outlook on the web) all other M365 services where accessible and working as expected.</p>
<p>Initially everyone thought that the error could be caused by a conditional access policy in Microsoft Entra ID, however conditional access policies should trigger at a much earlier stage, during the log-in. After checking the policies we found that there where none configured which would block access to access Outlook on the web (OWA) in Microsoft 365. Next all firewalls and proxies where checked and where possible disabled during troubleshooting. At this point a test set-up was created which allowed us to disable all network routing and security measures. The issue persisted&hellip;</p>
<p>Even WireShark traces didn&rsquo;t yield any useful information. The only thing that was clear from the traces was that the server was sending a 400 Bad Request response.</p>
<h2 class="heading-element" id="the-root-cause"><span>The Root Cause</span>
  <a href="#the-root-cause" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>After banging our heads on the wall I decided to go back to basics and have a look at the request and response using the developer tools available in any modern browser. This is where I noticed the following payload message:</p>
<figure><a class="lightgallery" href="/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/badRequestPayload.png" title="/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/badRequestPayload.png" data-thumbnail="/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/badRequestPayload.png" data-sub-html="<h2>ClientAccessRuleOWAErrorMEssage</h2>"><img loading="lazy" src='/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/badRequestPayload.png' alt="/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/badRequestPayload.png" height="473" width="1146"></a><figcaption class="image-caption">ClientAccessRuleOWAErrorMEssage</figcaption>
  </figure>
<p>While I am far from an expert in Exchange Online I do remember Client Access rules from back in the day when I had a couple of integration challenges with Exchange on-premises. I always assumed that the conditional access policies took over the functionality once provided by Client Access rules. But based on this message it seems that Exchange Online still has this functionality. For those who are not familiar what client access rules are an quick summary.</p>
<div class="details admonition info open">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-circle-info" aria-hidden="true"></i>Client Access Rules<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
  <div class="details-content">
    <div class="admonition-content">Client Access Rules help you control access to your Exchange Online based on client properties or client access requests. You can prevent clients from connecting to Exchange Online based on their IP address, authentication type, and user property values, and the protocol, application, service, or resource that they&rsquo;re using to connect. -
<a href="https://docs.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/client-access-rules/client-access-rules?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">source</a></div>
  </div>
</div>
<p>A quick search on the interwebs revealed that indeed the Client Access Rules are still available in Exchange Online. However they are deprecated and scheduled for retirement in September 2024. As illustrated by hte following image.</p>
<p><img loading="lazy" src='https://techcommunity.microsoft.com/t5/image/serverpage/image-id/458584i8BD620014953E882/image-dimensions/2500?v=v2&px=-1&wt.mc_id=DT-MVP-5005327' alt="CARs Retirement plan"></p>
<p><a href="https://techcommunity.microsoft.com/t5/exchange-team-blog/update-deprecation-of-client-access-rules-in-exchange-online/ba-p/3790165?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">Image source</a></p>
<h2 class="heading-element" id="the-solution"><span>The Solution</span>
  <a href="#the-solution" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Since the Client Access Rules are ancient technology the UI to manage them is not available in the Exchange Online admin center. Instead you have to use the <a href="https://www.powershellgallery.com/packages/ExchangeOnlineManagement/3.3.0"target="_blank" rel="external nofollow noopener noreferrer">ExchangeOnlineManagement</a> PowerShell module. The following snippet installs this module in the current user scope, imports it, connects to Exchange Online and lists all present Client Access Rules. Just make sure to change the <code>$exchangeAdminUpn</code> value to your Exchange admin.</p>
<script src="https://gist.github.com/devjevnl/ffa1f8c7791663f105fd0c1f6c987277.js?file=listAllClientAccessRules.ps1"></script>
<p>After running the snippet as expected a single Deny Access Client Access Rule was listed with the &lsquo;old&rsquo; IP address in the exception list.</p>
<figure><a class="lightgallery" href="/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/casPolicies.png" title="/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/casPolicies.png" data-thumbnail="/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/casPolicies.png" data-sub-html="<h2>Active Client Access Rule</h2>"><img loading="lazy" src='/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/casPolicies.png' alt="/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/casPolicies.png" height="747" width="1110"></a><figcaption class="image-caption">Active Client Access Rule</figcaption>
  </figure>
<p>As a quick fix I extended the exception list using the following snippet with the new IP address. The troublesome error <code>400 Bad Request. QWNjZXNzIHRvIE91dGxvb2sgb24gdGhlIHdlYiBoYXMgYmVlbiBibG9ja2VkIGJ5 IHlvdXIgb3JnYW5pemF0aW9uLiA8QlI+PEJSPkNsaWNrIDxhIGhyZWY9Ii9vd2Ev bG9nb2ZmLm93YSI+aGVyZTwvYT4gdG8gc2lnbiBvdXQu (Base64)</code> was no longer shown and all users where able to access Outlook.</p>
<script src="https://gist.github.com/devjevnl/ffa1f8c7791663f105fd0c1f6c987277.js?file=addNewIPtoClientAccessRule.ps1"></script>
<p>As shown in the above snippet I also added a new rule with the highest priority which allows access to remote PowerShell. I have done this to prevent myself from locking myself out in the future. This rule is an important safeguard to preserve access to your organization. Without this rule, if you create rules that block your access to remote PowerShell, or that block all protocols for everyone, you&rsquo;ll lose the ability to fix the rules yourself (you&rsquo;ll need to call Microsoft Customer Service and Support). - <a href="https://learn.microsoft.com/en-us/powershell/module/exchange/new-clientaccessrule?view=exchange-ps#example-1&amp;wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">source</a></p>
<p>Naturally the next step is to remove the deprecated Client Access Rules and replace them with Conditional Access Policies. However that requires a bit more planning, consideration and testing so it&rsquo;s a user story on our backlog.</p>
<p>If you are interested in the conditional access deployment you can find more information <a href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/plan-conditional-access?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">here</a>.</p>
<h2 class="heading-element" id="wrapping-up"><span>Wrapping up</span>
  <a href="#wrapping-up" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>And that&rsquo;s all folks! I hope you found this post helpful and/or educational. If you are interested in the reference material used to make this post, please visit the following links.</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/client-access-rules/client-access-rules?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">Client Access Rules in Exchange Online</a></li>
<li><a href="https://techcommunity.microsoft.com/t5/exchange-team-blog/update-deprecation-of-client-access-rules-in-exchange-online/ba-p/3790165?wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">Update: Deprecation of Client Access Rules in Exchange Online</a></li>
<li><a href="https://www.powershellgallery.com/packages/ExchangeOnlineManagement/3.3.0"target="_blank" rel="external nofollow noopener noreferrer">PowerShell Module - ExchangeOnlineManagement</a></li>
<li><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/new-clientaccessrule?view=exchange-ps#example-1&amp;wt.mc_id=DT-MVP-5005327"target="_blank" rel="external nofollow noopener noreferrer">New-ClientAccessRule</a></li>
</ul>
<p>As always, a big <strong>thanks</strong> for reading this post. If you liked it, don&rsquo;t be shy and have a look at my other <a href="/posts">posts</a>.</p>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Updated on 2024-04-29 02:00:00">Updated on 2024-04-29&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/exchange-online/" class="post-tag" title="Tags - Exchange Online">Exchange Online</a><a href="/tags/outlook/" class="post-tag" title="Tags - Outlook">Outlook</a><a href="/tags/microsoft-365/" class="post-tag" title="Tags - Microsoft 365">Microsoft 365</a><a href="/tags/troubleshooting/" class="post-tag" title="Tags - Troubleshooting">Troubleshooting</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/2024/how-to-build-and-use-your-own-container-with-azure-devops-container-jobs/" class="post-nav-item" rel="prev" title="üõ†Ô∏è How to Build and Use Your Own Container With Azure DevOps Container Jobs üöÄüì¶"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>üõ†Ô∏è How to Build and Use Your Own Container With Azure DevOps Container Jobs üöÄüì¶</a><a href="/posts/2024/i-am-in-your-pipeline-decorating-it-with-compliance/" class="post-nav-item" rel="next" title="üöÄ‚ú® I Am in Your Pipeline, Decorating It With Compliance üõ†Ô∏èüîí">üöÄ‚ú® I Am in Your Pipeline, Decorating It With Compliance üõ†Ô∏èüîí<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="custom-footer-text">
  <p>¬© 2025 Jev Suchoi - Let's automate the boring! </p>
</div>
<div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">
              <a href="/"></a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="/posts/2024/400-bad-request-access-to-outlook-on-the-web-has-been-blocked-by-your-organization/config.js" defer></script><script src="/js/theme.min.js" defer></script><script>
      window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
      gtag('config', 'G-J3E897NYLC');
    </script><script src="https://www.googletagmanager.com/gtag/js?id=G-J3E897NYLC" async></script></body>
</html>
